library(reshape2)
library(ggplot2)
time2 <- scan("time2.csv")
reduced2 <- scan("reduced2.csv")
timer <- scan("timer.csv")
reducedr <- scan("reducedr.csv")
time3 <- scan("time3.csv")
reduced3 <- scan("reduced3.csv")
time4 <- scan("time4.csv")
reduced4 <- scan("reduced4.csv")
time5 <- scan("time5.csv")
reduced5 <- scan("reduced5.csv")
time6 <- scan("time6.csv")
reduced6 <- scan("reduced6.csv")
time7 <- scan("time7.csv")
reduced7 <- scan("reduced7.csv")
time8 <- scan("time8.csv")
reduced8 <- scan("reduced8.csv")
time9 <- scan("time9.csv")
reduced9 <- scan("reduced9.csv")
time11 <- scan("time11.csv")
reduced11 <- scan("reduced11.csv")
time12 <- scan("time12.csv")
reduced12 <- scan("reduced12.csv")
time13 <- scan("time13.csv")
reduced13 <- scan("reduced13.csv")
time14 <- scan("time14.csv")
reduced14 <- scan("reduced14.csv")
time15 <- scan("time15.csv")
reduced15 <- scan("reduced15.csv")
time16 <- scan("time16.csv")
reduced16 <- scan("reduced16.csv")
time17 <- scan("time17.csv")
reduced17 <- scan("reduced17.csv")
ir <- (0:(length(timer)-1))
xr <- ir/(max(timer)*3600)
yr <- 2/(length(timer)-1)*Mod(fft(reducedr))
i2 <- (0:(length(time2)-1))
x2 <- i2/(max(time2)*3600)
y2 <- 2/(length(time2)-1)*Mod(fft(reduced2))
i3 <- (0:(length(time3)-1))
x3 <- i3/(max(time3)*3600)
y3 <- 2/(length(time3)-1)*Mod(fft(reduced3))
i4 <- (0:(length(time4)-1))
x4 <- i4/(max(time4)*3600)
y4 <- 2/(length(time4)-1)*Mod(fft(reduced4))
i5 <- (0:(length(time5)-1))
x5 <- i5/(max(time5)*3600)
y5 <- 2/(length(time5)-1)*Mod(fft(reduced5))
i6 <- (0:(length(time6)-1))
x6 <- i6/(max(time6)*3600)
y6 <- 2/(length(time6)-1)*Mod(fft(reduced6))
i7 <- (0:(length(time7)-1))
x7 <- i7/(max(time7)*3600)
y7 <- 2/(length(time7)-1)*Mod(fft(reduced7))
i8 <- (0:(length(time8)-1))
x8 <- i8/(max(time8)*3600)
y8 <- 2/(length(time8)-1)*Mod(fft(reduced8))
i9 <- (0:(length(time9)-1))
x9 <- i9/(max(time9)*3600)
y9 <- 2/(length(time9)-1)*Mod(fft(reduced9))
i11 <- (0:(length(time11)-1))
x11 <- i11/(max(time11)*3600)
y11 <- 2/(length(time11)-1)*Mod(fft(reduced11))
i12 <- (0:(length(time12)-1))
x12 <- i12/(max(time12)*3600)
y12 <- 2/(length(time12)-1)*Mod(fft(reduced12))
i13 <- (0:(length(time13)-1))
x13 <- i13/(max(time13)*3600)
y13 <- 2/(length(time13)-1)*Mod(fft(reduced13))
i14 <- (0:(length(time14)-1))
x14 <- i14/(max(time14)*3600)
y14 <- 2/(length(time14)-1)*Mod(fft(reduced14))
i15 <- (0:(length(time15)-1))
x15 <- i15/(max(time15)*3600)
y15 <- 2/(length(time15)-1)*Mod(fft(reduced15))
i16 <- (0:(length(time16)-1))
x16 <- i16/(max(time16)*3600)
y16 <- 2/(length(time16)-1)*Mod(fft(reduced16))
i17 <- (0:(length(time17)-1))
x17 <- i17/(max(time17)*3600)
y17 <- 2/(length(time17)-1)*Mod(fft(reduced17))
df1 <- data.frame(xr[1:3000], x2[1:3000], x3[1:3000], x4[1:3000], x5[1:3000], x6[1:3000], x7[1:3000], x8[1:3000], x9[1:3000], x11[1:3000], x12[1:3000], x13[1:3000], x14[1:3000], x15[1:3000], x16[1:3000], x17[1:3000], yr[1:3000], y2[1:3000], y3[1:3000], y4[1:3000], y5[1:3000], y6[1:3000], y7[1:3000], y8[1:3000], y9[1:3000], y11[1:3000], y12[1:3000], y13[1:3000], y14[1:3000], y15[1:3000], y16[1:3000], y17[1:3000] )
dfp1 <- melt(df1)
fac <- dfp1$variable[48001:96000]
xc <- dfp1$value[1:48000]
yc <- dfp1$value[48001:96000]
df <- data.frame(xc, yc, fac)
a <- ggplot(df, aes(xc, yc*10000,  fill = fac))+ geom_bar(stat = "identity", position="identity", aes(colour = factor(fac)), width= 0.000000001) + geom_text(aes(label=fac),  position = "bottom", nudge_x = 0, nudge_y = 0.25) + xlab("Frequency (1/sec)") +  ylab("Log. of Amplitude (ft/10000)") 

a + scale_y_continuous( trans = "log10", limits = c(1,100000), expand=c(0,0.01)) + scale_x_continuous(limits = c(0.00002230,0.00002245))     
